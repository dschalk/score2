<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>IMPOSSIBLES.html</title>
  <meta name="generator" content="Haroopad 0.13.1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>div.oembedall-githubrepos{border:1px solid #DDD;border-radius:4px;list-style-type:none;margin:0 0 10px;padding:8px 10px 0;font:13.34px/1.4 helvetica,arial,freesans,clean,sans-serif;width:452px;background-color:#fff}div.oembedall-githubrepos .oembedall-body{background:-moz-linear-gradient(center top,#FAFAFA,#EFEFEF);background:-webkit-gradient(linear,left top,left bottom,from(#FAFAFA),to(#EFEFEF));border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-top:1px solid #EEE;margin-left:-10px;margin-top:8px;padding:5px 10px;width:100%}div.oembedall-githubrepos h3{font-size:14px;margin:0;padding-left:18px;white-space:nowrap}div.oembedall-githubrepos p.oembedall-description{color:#444;font-size:12px;margin:0 0 3px}div.oembedall-githubrepos p.oembedall-updated-at{color:#888;font-size:11px;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats{border:none;float:right;font-size:11px;font-weight:700;padding-left:15px;position:relative;z-index:5;margin:0}div.oembedall-githubrepos ul.oembedall-repo-stats li{border:none;color:#666;display:inline-block;list-style-type:none;margin:0!important}div.oembedall-githubrepos ul.oembedall-repo-stats li a{background-color:transparent;border:none;color:#666!important;background-position:5px -2px;background-repeat:no-repeat;border-left:1px solid #DDD;display:inline-block;height:21px;line-height:21px;padding:0 5px 0 23px}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a{border-left:medium none;margin-right:-3px}div.oembedall-githubrepos ul.oembedall-repo-stats li a:hover{background:5px -27px no-repeat #4183C4;color:#FFF!important;text-decoration:none}div.oembedall-githubrepos ul.oembedall-repo-stats li:first-child a:hover{border-bottom-left-radius:3px;border-top-left-radius:3px}ul.oembedall-repo-stats li:last-child a:hover{border-bottom-right-radius:3px;border-top-right-radius:3px}span.oembedall-closehide{background-color:#aaa;border-radius:2px;cursor:pointer;margin-right:3px}div.oembedall-container{margin-top:5px;text-align:left}.oembedall-ljuser{font-weight:700}.oembedall-ljuser img{vertical-align:bottom;border:0;padding-right:1px}.oembedall-stoqembed{border-bottom:1px dotted #999;float:left;overflow:hidden;width:730px;line-height:1;background:#FFF;color:#000;font-family:Arial,Liberation Sans,DejaVu Sans,sans-serif;font-size:80%;text-align:left;margin:0;padding:0}.oembedall-stoqembed a{color:#07C;text-decoration:none;margin:0;padding:0}.oembedall-stoqembed a:hover{text-decoration:underline}.oembedall-stoqembed a:visited{color:#4A6B82}.oembedall-stoqembed h3{font-family:Trebuchet MS,Liberation Sans,DejaVu Sans,sans-serif;font-size:130%;font-weight:700;margin:0;padding:0}.oembedall-stoqembed .oembedall-reputation-score{color:#444;font-size:120%;font-weight:700;margin-right:2px}.oembedall-stoqembed .oembedall-user-info{height:35px;width:185px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-gravatar32{float:left;height:32px;width:32px}.oembedall-stoqembed .oembedall-user-info .oembedall-user-details{float:left;margin-left:5px;overflow:hidden;white-space:nowrap;width:145px}.oembedall-stoqembed .oembedall-question-hyperlink{font-weight:700}.oembedall-stoqembed .oembedall-stats{background:#EEE;margin:0 0 0 7px;padding:4px 7px 6px;width:58px}.oembedall-stoqembed .oembedall-statscontainer{float:left;margin-right:8px;width:86px}.oembedall-stoqembed .oembedall-votes{color:#555;padding:0 0 7px;text-align:center}.oembedall-stoqembed .oembedall-vote-count-post{font-size:240%;color:#808185;display:block;font-weight:700}.oembedall-stoqembed .oembedall-views{color:#999;padding-top:4px;text-align:center}.oembedall-stoqembed .oembedall-status{margin-top:-3px;padding:4px 0;text-align:center;background:#75845C;color:#FFF}.oembedall-stoqembed .oembedall-status strong{color:#FFF;display:block;font-size:140%}.oembedall-stoqembed .oembedall-summary{float:left;width:635px}.oembedall-stoqembed .oembedall-excerpt{line-height:1.2;margin:0;padding:0 0 5px}.oembedall-stoqembed .oembedall-tags{float:left;line-height:18px}.oembedall-stoqembed .oembedall-tags a:hover{text-decoration:none}.oembedall-stoqembed .oembedall-post-tag{background-color:#E0EAF1;border-bottom:1px solid #3E6D8E;border-right:1px solid #7F9FB6;color:#3E6D8E;font-size:90%;line-height:2.4;margin:2px 2px 2px 0;padding:3px 4px;text-decoration:none;white-space:nowrap}.oembedall-stoqembed .oembedall-post-tag:hover{background-color:#3E6D8E;border-bottom:1px solid #37607D;border-right:1px solid #37607D;color:#E0EAF1}.oembedall-stoqembed .oembedall-fr{float:right}.oembedall-stoqembed .oembedall-statsarrow{background-image:url(http://cdn.sstatic.net/stackoverflow/img/sprites.png?v=3);background-repeat:no-repeat;overflow:hidden;background-position:0 -435px;float:right;height:13px;margin-top:12px;width:7px}.oembedall-facebook1{border:1px solid #1A3C6C;padding:0;font:13.34px/1.4 verdana;width:500px}.oembedall-facebook2{background-color:#627add}.oembedall-facebook2 a{color:#e8e8e8;text-decoration:none}.oembedall-facebookBody{background-color:#fff;vertical-align:top;padding:5px}.oembedall-facebookBody .contents{display:inline-block;width:100%}.oembedall-facebookBody div img{float:left;margin-right:5px}div.oembedall-lanyard{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:.4000000059604645s;-webkit-transition-property:width;-webkit-transition-timing-function:cubic-bezier(0.42,0,.58,1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:none;background-origin:padding-box;border-width:0;box-shadow:none;color:#112644;display:block;float:left;font-family:'Trebuchet MS',Trebuchet,sans-serif;font-size:16px;height:253px;line-height:19px;margin:0;max-width:none;min-height:0;outline:#112644 0;overflow-x:visible;overflow-y:visible;padding:0;position:relative;text-align:left;vertical-align:baseline;width:804px}div.oembedall-lanyard .tagline{font-size:1.5em}div.oembedall-lanyard .wrapper{overflow:hidden;clear:both}div.oembedall-lanyard .split{float:left;display:inline}div.oembedall-lanyard .prominent-place .flag:active,div.oembedall-lanyard .prominent-place .flag:focus,div.oembedall-lanyard .prominent-place .flag:hover,div.oembedall-lanyard .prominent-place .flag:link,div.oembedall-lanyard .prominent-place .flag:visited{float:left;display:block;width:48px;height:48px;position:relative;top:-5px;margin-right:10px}div.oembedall-lanyard .place-context{font-size:.889em}div.oembedall-lanyard .prominent-place .sub-place{display:block}div.oembedall-lanyard .prominent-place{font-size:1.125em;line-height:1.1em;font-weight:400}div.oembedall-lanyard .main-date{color:#8CB4E0;font-weight:700;line-height:1.1}div.oembedall-lanyard .first{width:48.57%;margin:0 0 0 2.857%}.mermaid .label{color:#333}.node circle,.node polygon,.node rect{fill:#cde498;stroke:#13540c;stroke-width:1px}.edgePath .path{stroke:green;stroke-width:1.5px}.cluster rect{fill:#cdffb2;rx:40;stroke:#6eaa49;stroke-width:1px}.cluster text{fill:#333}.actor{stroke:#13540c;fill:#cde498}text.actor{fill:#000;stroke:none}.actor-line{stroke:grey}.messageLine0{stroke-width:1.5;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#333}.messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#arrowhead{fill:#333}#crosshead path{fill:#333!important;stroke:#333!important}.messageText{fill:#333;stroke:none}.labelBox{stroke:#326932;fill:#cde498}.labelText,.loopText{fill:#000;stroke:none}.loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#326932}.note{stroke:#6eaa49;fill:#fff5ad}.noteText{fill:#000;stroke:none;font-family:'trebuchet ms',verdana,arial;font-size:14px}.section{stroke:none;opacity:.2}.section0,.section2{fill:#6eaa49}.section1,.section3{fill:#fff;opacity:.2}.sectionTitle0,.sectionTitle1,.sectionTitle2,.sectionTitle3{fill:#333}.sectionTitle{text-anchor:start;font-size:11px;text-height:14px}.grid .tick{stroke:lightgrey;opacity:.3;shape-rendering:crispEdges}.grid path{stroke-width:0}.today{fill:none;stroke:red;stroke-width:2px}.task{stroke-width:2}.taskText{text-anchor:middle;font-size:11px}.taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}.taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}.taskText0,.taskText1,.taskText2,.taskText3{fill:#fff}.task0,.task1,.task2,.task3{fill:#487e3a;stroke:#13540c}.taskTextOutside0,.taskTextOutside1,.taskTextOutside2,.taskTextOutside3{fill:#000}.active0,.active1,.active2,.active3{fill:#cde498;stroke:#13540c}.activeText0,.activeText1,.activeText2,.activeText3{fill:#000!important}.done0,.done1,.done2,.done3{stroke:grey;fill:lightgrey;stroke-width:2}.doneText0,.doneText1,.doneText2,.doneText3{fill:#000!important}.crit0,.crit1,.crit2,.crit3{stroke:#f88;fill:red;stroke-width:2}.activeCrit0,.activeCrit1,.activeCrit2,.activeCrit3{stroke:#f88;fill:#cde498;stroke-width:2}.doneCrit0,.doneCrit1,.doneCrit2,.doneCrit3{stroke:#f88;fill:lightgrey;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}.activeCritText0,.activeCritText1,.activeCritText2,.activeCritText3,.doneCritText0,.doneCritText1,.doneCritText2,.doneCritText3{fill:#000!important}.titleText{text-anchor:middle;font-size:18px;fill:#000}text{font-family:'trebuchet ms',verdana,arial;font-size:14px}html{height:100%}body{margin:0!important;padding:5px 20px 26px!important;background-color:#fff;font-family:"Lucida Grande","Segoe UI","Apple SD Gothic Neo","Malgun Gothic","Lucida Sans Unicode",Helvetica,Arial,sans-serif;font-size:.9em;overflow-x:hidden;overflow-y:auto}br,h1,h2,h3,h4,h5,h6{clear:both}hr.page{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x;border:0;height:3px;padding:0}hr.underscore{border-top-style:dashed!important}body >:first-child{margin-top:0!important}img.plugin{box-shadow:0 1px 3px rgba(0,0,0,.1);border-radius:3px}iframe{border:0}figure{-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0}kbd{border:1px solid #aaa;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:1px 2px 2px #ddd;-webkit-box-shadow:1px 2px 2px #ddd;box-shadow:1px 2px 2px #ddd;background-color:#f9f9f9;background-image:-moz-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-o-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:-webkit-linear-gradient(top,#eee,#f9f9f9,#eee);background-image:linear-gradient(top,#eee,#f9f9f9,#eee);padding:1px 3px;font-family:inherit;font-size:.85em}.oembeded .oembed_photo{display:inline-block}img[data-echo]{margin:25px 0;width:100px;height:100px;background:url(../img/ajax.gif) center center no-repeat #fff}.spinner{display:inline-block;width:10px;height:10px;margin-bottom:-.1em;border:2px solid rgba(0,0,0,.5);border-top-color:transparent;border-radius:100%;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.spinner:after{content:'';display:block;width:0;height:0;position:absolute;top:-6px;left:0;border:4px solid transparent;border-bottom-color:rgba(0,0,0,.5);-webkit-transform:rotate(45deg);transform:rotate(45deg)}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}p.toc{margin:0!important}p.toc ul{padding-left:10px}p.toc>ul{padding:10px;margin:0 10px;display:inline-block;border:1px solid #ededed;border-radius:5px}p.toc li,p.toc ul{list-style-type:none}p.toc li{width:100%;padding:0;overflow:hidden}p.toc li a::after{content:"."}p.toc li a:before{content:"• "}p.toc h5{text-transform:uppercase}p.toc .title{float:left;padding-right:3px}p.toc .number{margin:0;float:right;padding-left:3px;background:#fff;display:none}input.task-list-item{margin-left:-1.62em}.markdown{font-family:"Hiragino Sans GB","Microsoft YaHei",STHeiti,SimSun,"Lucida Grande","Lucida Sans Unicode","Lucida Sans",'Segoe UI',AppleSDGothicNeo-Medium,'Malgun Gothic',Verdana,Tahoma,sans-serif;padding:20px}.markdown a{text-decoration:none;vertical-align:baseline}.markdown a:hover{text-decoration:underline}.markdown h1{font-size:2.2em;font-weight:700;margin:1.5em 0 1em}.markdown h2{font-size:1.8em;font-weight:700;margin:1.275em 0 .85em}.markdown h3{font-size:1.6em;font-weight:700;margin:1.125em 0 .75em}.markdown h4{font-size:1.4em;font-weight:700;margin:.99em 0 .66em}.markdown h5{font-size:1.2em;font-weight:700;margin:.855em 0 .57em}.markdown h6{font-size:1em;font-weight:700;margin:.75em 0 .5em}.markdown h1+p,.markdown h1:first-child,.markdown h2+p,.markdown h2:first-child,.markdown h3+p,.markdown h3:first-child,.markdown h4+p,.markdown h4:first-child,.markdown h5+p,.markdown h5:first-child,.markdown h6+p,.markdown h6:first-child{margin-top:0}.markdown hr{border:1px solid #ccc}.markdown p{margin:1em 0;word-wrap:break-word}.markdown ol{list-style-type:decimal}.markdown li{display:list-item;line-height:1.4em}.markdown blockquote{margin:1em 20px}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown blockquote cite:before{content:'\2014 \00A0'}.markdown .code{border-radius:3px;word-wrap:break-word}.markdown pre{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;overflow:auto;padding:.5em}.markdown pre code{border:0;display:block}.markdown pre>code{font-family:Consolas,Inconsolata,Courier,monospace;font-weight:700;white-space:pre;margin:0}.markdown code{border-radius:3px;word-wrap:break-word;border:1px solid #ccc;padding:0 5px;margin:0 2px}.markdown img{max-width:100%}.markdown mark{color:#000;background-color:#fcf8e3}.markdown table{padding:0;border-collapse:collapse;border-spacing:0;margin-bottom:16px}.markdown table tr td,.markdown table tr th{border:1px solid #ccc;margin:0;padding:6px 13px}.markdown table tr th{font-weight:700}.markdown table tr th>:first-child{margin-top:0}.markdown table tr th>:last-child{margin-bottom:0}.markdown table tr td>:first-child{margin-top:0}.markdown table tr td>:last-child{margin-bottom:0}.node-dark{padding:20px;color:#d2d8ba;font-size:15px;background:#33342d;-webkit-font-smoothing:antialiased}.node-dark a{color:#639400}.node-dark a:hover{color:#85c700}.node-dark h1,.node-dark h2,.node-dark h3,.node-dark h4,.node-dark h5{color:#eee}.node-dark h2{border-bottom:1px solid #4e4f45;line-height:1.7em}.node-dark h6{color:#694f00}.node-dark hr{border:1px solid #2b2c26}.node-dark pre>code{font-size:1em}.node-dark blockquote{border-left:4px solid #181915;padding:0 15px;font-style:italic}.node-dark table{background-color:#3d3e36}.node-dark table tr td,.node-dark table tr th{border:1px solid #5f6154}.node-dark table tr:nth-child(2n){background-color:#46483e}.hljs{display:block;overflow-x:auto;padding:.5em;background:#272822;-webkit-text-size-adjust:none}.hljs-change,.hljs-flow,.hljs-keyword,.hljs-literal,.hljs-strong,.hljs-tag,.hljs-tag .hljs-title,.hljs-winutils,.nginx .hljs-title,.tex .hljs-special{color:#f92672}.hljs{color:#ddd}.asciidoc .hljs-code,.hljs .hljs-constant,.markdown .hljs-code{color:#66d9ef}.hljs-class .hljs-title,.hljs-code,.hljs-header{color:#fff}.hljs-attribute,.hljs-link_label,.hljs-regexp,.hljs-symbol,.hljs-symbol .hljs-string,.hljs-value{color:#bf79db}.apache .hljs-cbracket,.apache .hljs-tag,.django .hljs-filter .hljs-argument,.django .hljs-template_tag,.django .hljs-variable,.hljs-addition,.hljs-attr_selector,.hljs-built_in,.hljs-bullet,.hljs-emphasis,.hljs-envvar,.hljs-javadoc,.hljs-link_url,.hljs-pragma,.hljs-preprocessor,.hljs-prompt,.hljs-pseudo,.hljs-stream,.hljs-string,.hljs-subst,.hljs-tag .hljs-value,.hljs-title,.hljs-type,.ruby .hljs-class .hljs-parent,.smalltalk .hljs-array,.smalltalk .hljs-class,.smalltalk .hljs-localvars,.tex .hljs-command{color:#a6e22e}.apache .hljs-sqbracket,.hljs-annotation,.hljs-blockquote,.hljs-comment,.hljs-decorator,.hljs-deletion,.hljs-doctype,.hljs-horizontal_rule,.hljs-pi,.hljs-shebang,.smartquote,.tex .hljs-formula{color:#75715e}.apache .hljs-tag,.bash .hljs-variable,.css .hljs-id,.diff .hljs-header,.hljs-chunk,.hljs-dartdoc,.hljs-header,.hljs-keyword,.hljs-literal,.hljs-phpdoc,.hljs-request,.hljs-status,.hljs-title,.hljs-type,.hljs-winutils,.rsl .hljs-built_in,.smalltalk .hljs-class,.tex .hljs-special,.vbscript .hljs-built_in{font-weight:700}.coffeescript .javascript,.javascript .xml,.tex .hljs-formula,.xml .css,.xml .hljs-cdata,.xml .javascript,.xml .vbscript{opacity:.5}.MathJax_Hover_Frame{border-radius:.25em;-webkit-border-radius:.25em;-moz-border-radius:.25em;-khtml-border-radius:.25em;box-shadow:0 0 15px #83A;-webkit-box-shadow:0 0 15px #83A;-moz-box-shadow:0 0 15px #83A;-khtml-box-shadow:0 0 15px #83A;border:1px solid #A6D!important;display:inline-block;position:absolute}.MathJax_Hover_Arrow{position:absolute;width:15px;height:11px;cursor:pointer}#MathJax_About{position:fixed;left:50%;width:auto;text-align:center;border:3px outset;padding:1em 2em;background-color:#DDD;color:#000;cursor:default;font-family:message-box;font-size:120%;font-style:normal;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px;-khtml-border-radius:15px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_Menu{position:absolute;background-color:#fff;color:#000;width:auto;padding:5px 0;border:1px solid #CCC;margin:0;cursor:default;font:menu;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;z-index:201;border-radius:5px;-webkit-border-radius:5px;-moz-border-radius:5px;-khtml-border-radius:5px;box-shadow:0 10px 20px gray;-webkit-box-shadow:0 10px 20px gray;-moz-box-shadow:0 10px 20px gray;-khtml-box-shadow:0 10px 20px gray;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}.MathJax_MenuItem{padding:1px 2em;background:0 0}.MathJax_MenuArrow{position:absolute;right:.5em;color:#666}.MathJax_MenuActive .MathJax_MenuArrow{color:#fff}.MathJax_MenuArrow.RTL{left:.5em;right:auto}.MathJax_MenuCheck{position:absolute;left:.7em}.MathJax_MenuCheck.RTL{right:.7em;left:auto}.MathJax_MenuRadioCheck{position:absolute;left:.7em}.MathJax_MenuRadioCheck.RTL{right:.7em;left:auto}.MathJax_MenuLabel{padding:1px 2em 3px 1.33em;font-style:italic}.MathJax_MenuRule{border-top:1px solid #DDD;margin:4px 3px}.MathJax_MenuDisabled{color:GrayText}.MathJax_MenuActive{background-color:#606872;color:#fff}.MathJax_Menu_Close{position:absolute;width:31px;height:31px;top:-15px;left:-15px}#MathJax_Zoom{position:absolute;background-color:#F0F0F0;overflow:auto;display:block;z-index:301;padding:.5em;border:1px solid #000;margin:0;font-weight:400;font-style:normal;text-align:left;text-indent:0;text-transform:none;line-height:normal;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;box-shadow:5px 5px 15px #AAA;-webkit-box-shadow:5px 5px 15px #AAA;-moz-box-shadow:5px 5px 15px #AAA;-khtml-box-shadow:5px 5px 15px #AAA;filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}#MathJax_ZoomOverlay{position:absolute;left:0;top:0;z-index:300;display:inline-block;width:100%;height:100%;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}#MathJax_ZoomFrame{position:relative;display:inline-block;height:0;width:0}#MathJax_ZoomEventTrap{position:absolute;left:0;top:0;z-index:302;display:inline-block;border:0;padding:0;margin:0;background-color:#fff;opacity:0;filter:alpha(opacity=0)}.MathJax_Preview{color:#888}#MathJax_Message{position:fixed;left:1px;bottom:2px;background-color:#E6E6E6;border:1px solid #959595;margin:0;padding:2px 8px;z-index:102;color:#000;font-size:80%;width:auto;white-space:nowrap}#MathJax_MSIE_Frame{position:absolute;top:0;left:0;width:0;z-index:101;border:0;margin:0;padding:0}.MathJax_Error{color:#C00;font-style:italic}footer{position:fixed;font-size:.8em;text-align:right;bottom:0;margin-left:-25px;height:20px;width:100%}
  ul {
    color: #000000;
  } 
  li {
    color: #000000;
  }
  a {
    color: #000000;
  }
  body {
    background-color: #a4f2ed;
  }
  </style>
</head>
<body class="markdown node-dark">
<div style="padding: 10%">
<a id="topofRules" class="anchor" aria-hidden="true"></a>
<br><p><strong>IMPOSSIBLES</strong></p>
<p>The essence of the Score calculation algorythm in the module Fm is contained in the “impossibles.hs” file. Fm has much formatting code, which is a distraction when evaluating the algorythm.</p><p>impossibles.hs computes all dice combinations which cannot be made into the number “20” in two or three stages. In 1.5 seconds, it finds all 104 such combinations using a list comprehension on the seven list comprehensions which cover all possible computations. The five operations are defined as follows:</p><pre class="haskell hljs"><code class="haskell" data-origin="<pre><code class=&quot;haskell&quot;>{-# LANGUAGE OverloadedStrings #-}

import Data.List
import System.CPUTime

notWhole :: Double -&amp;gt; Bool
notWhole x = fromIntegral (round x) /= x

cat :: Double -&amp;gt; Double -&amp;gt; Double
cat l m   | m &amp;lt; 0  = 3.1
          | l == 0  = 3.1
          | notWhole l  = 3.1
          | notWhole m  = 3.1
          | otherwise  = read (show (round l) ++ show (round m))

f :: Double -&amp;gt; String
f x = show (round x)

scoreDiv :: (Eq a, Fractional a) =&amp;gt; a -&amp;gt; a -&amp;gt; a
scoreDiv az bz  | bz == 0  = 99999
                | otherwise = (/) az bz

ops =  [cat, (+), (-), (*), scoreDiv]
</code></pre>"><span class="hljs-pragma">{-# LANGUAGE OverloadedStrings #-}</span>

<span class="hljs-import"><span class="hljs-keyword">import</span> Data.List</span>
<span class="hljs-import"><span class="hljs-keyword">import</span> System.CPUTime</span>

<span class="hljs-title">notWhole</span> :: <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Bool</span>
<span class="hljs-title">notWhole</span> x = fromIntegral (round x) /= x

<span class="hljs-title">cat</span> :: <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span>
<span class="hljs-title">cat</span> l m   | m &lt; <span class="hljs-number">0</span>  = <span class="hljs-number">3.1</span>
          | l == <span class="hljs-number">0</span>  = <span class="hljs-number">3.1</span>
          | notWhole l  = <span class="hljs-number">3.1</span>
          | notWhole m  = <span class="hljs-number">3.1</span>
          | otherwise  = read (show (round l) ++ show (round m))

<span class="hljs-title">f</span> :: <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">String</span>
<span class="hljs-title">f</span> x = show (round x)

<span class="hljs-title">scoreDiv</span> :: (<span class="hljs-type">Eq</span> a, <span class="hljs-type">Fractional</span> a) =&gt; a -&gt; a -&gt; a
<span class="hljs-title">scoreDiv</span> az bz  | bz == <span class="hljs-number">0</span>  = <span class="hljs-number">99999</span>
                | otherwise = (/) az bz

<span class="hljs-title">ops</span> =  [cat, (+), (-), (*), scoreDiv]
</code></pre><p>The seven algorythms necessary to perform every possible computation are:</p><pre class="haskell hljs"><code class="haskell" data-origin="<pre><code class=&quot;haskell&quot;>calc :: Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; [(Double, Double, Double, Double)]
calc a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op2 (op1 a' b') c' == 20]

calc2 :: Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; [(Double, Double, Double, Double)]
calc2 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op2 a' (op1 b' c') == 20]

calc3 :: Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; [(Double, Double, Double, Double)]
calc3 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op3 &amp;lt;- ops,
                            op3 (op1 a' b') (op2 c' d') == 20]

calc4 :: Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; [(Double, Double, Double, Double)]
calc4 a b c d = [ (a',b',c',d')  |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op3 &amp;lt;- ops,
                            op3 (op2 (op1 a' b') c') d' == 20]

calc5 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op3 &amp;lt;- ops,
                            op3 (op2 a' (op1 b' c')) d' == 20]

calc6 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op3 &amp;lt;- ops,
                            op3 a' (op2 (op1 b' c') d') == 20]

calc7 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op3 &amp;lt;- ops,
                            op3 a' (op2 b' (op1 c' d')) == 20]
</code></pre>"><span class="hljs-title">calc</span> :: <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; [(<span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>)]
<span class="hljs-title">calc</span> a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op2 (op1 a' b') c' == <span class="hljs-number">20</span>]

<span class="hljs-title">calc2</span> :: <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; [(<span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>)]
<span class="hljs-title">calc2</span> a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op2 a' (op1 b' c') == <span class="hljs-number">20</span>]

<span class="hljs-title">calc3</span> :: <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; [(<span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>)]
<span class="hljs-title">calc3</span> a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op3 &lt;- ops,
                            op3 (op1 a' b') (op2 c' d') == <span class="hljs-number">20</span>]

<span class="hljs-title">calc4</span> :: <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; [(<span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>)]
<span class="hljs-title">calc4</span> a b c d = [ (a',b',c',d')  |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op3 &lt;- ops,
                            op3 (op2 (op1 a' b') c') d' == <span class="hljs-number">20</span>]

<span class="hljs-title">calc5</span> a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op3 &lt;- ops,
                            op3 (op2 a' (op1 b' c')) d' == <span class="hljs-number">20</span>]

<span class="hljs-title">calc6</span> a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op3 &lt;- ops,
                            op3 a' (op2 (op1 b' c') d') == <span class="hljs-number">20</span>]

<span class="hljs-title">calc7</span> a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op3 &lt;- ops,
                            op3 a' (op2 b' (op1 c' d')) == <span class="hljs-number">20</span>]
</code></pre><p>It is easy to see that there are seven ways to order two or three sequential computations on four numbers. They can be represented by </p><pre class="javascript hljs"><code class="javascript" data-origin="<pre><code class=&quot;javascript&quot;>a bc
ab c
ab cd
(a bc)d
(ab c)d
a(b cd)
a(bc d)
</code></pre>">a bc
ab c
ab cd
(a bc)d
(ab c)d
a(b cd)
a(bc d)
</code></pre><p>Those are the combinations used in the seven calc functions. The list comprehension works on all permutations of the order of the four numbers in receives, so c ba is covered by a bc. Next, I wanted to find out if all seven algorythms are necessary to find at least one solution, so I wrote this:</p><pre class="haskell hljs"><code class="haskell" data-origin="<pre><code class=&quot;haskell&quot;>{-# LANGUAGE OverloadedStrings #-}

import Data.List
import System.CPUTime

notWhole :: Double -&amp;gt; Bool
notWhole x = fromIntegral (round x) /= x

cat :: Double -&amp;gt; Double -&amp;gt; Double
cat l m   | m &amp;lt; 0  = 3.1
          | l == 0  = 3.1
          | notWhole l  = 3.1
          | notWhole m  = 3.1
          | otherwise  = read (show (round l) ++ show (round m))

f :: Double -&amp;gt; String
f x = show (round x)

scoreDiv :: (Eq a, Fractional a) =&amp;gt; a -&amp;gt; a -&amp;gt; a
scoreDiv az bz  | bz == 0  = 99999
                | otherwise = (/) az bz

ops =  [cat, (+), (-), (*), scoreDiv] 

calc :: Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; [(Double, Double, Double, Double)]
calc a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op2 (op1 a' b') c' == 20]

calc2 :: Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; [(Double, Double, Double, Double)]
calc2 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op2 a' (op1 b' c') == 20]

calc3 :: Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; [(Double, Double, Double, Double)]
calc3 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op3 &amp;lt;- ops,
                            op3 (op1 a' b') (op2 c' d') == 20]

calc4 :: Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; [(Double, Double, Double, Double)]
calc4 a b c d = [ (a',b',c',d')  |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op3 &amp;lt;- ops,
                            op3 (op2 (op1 a' b') c') d' == 20]

calc5 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op3 &amp;lt;- ops,
                            op3 (op2 a' (op1 b' c')) d' == 20]

calc6 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op3 &amp;lt;- ops,
                            op3 a' (op2 (op1 b' c') d') == 20]

calc7 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op3 &amp;lt;- ops,
                            op3 a' (op2 b' (op1 c' d')) == 20]



only_calc = [ [a, b, c, d] | a &amp;lt;- [1..6], b &amp;lt;- [1..6], c &amp;lt;- [1..12], d &amp;lt;- [1..20], 
                     a &amp;lt;= b, b &amp;lt;= c, c &amp;lt;= d,
                     not (null $ calc a b c d), null $ calc2 a b c d, null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, null $ calc6 a b c d, 
                     null $ calc7 a b c d ]


only_calc2 = [ [a, b, c, d] | a &amp;lt;- [1..6], b &amp;lt;- [1..6], c &amp;lt;- [1..12], d &amp;lt;- [1..20], 
                     a &amp;lt;= b, b &amp;lt;= c, c &amp;lt;= d,
                     null $ calc a b c d, not (null $ calc2 a b c d), null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, null $ calc6 a b c d, 
                     null $ calc7 a b c d ]

only_calc3 = [ [a, b, c, d] | a &amp;lt;- [1..6], b &amp;lt;- [1..6], c &amp;lt;- [1..12], d &amp;lt;- [1..20], 
                     a &amp;lt;= b, b &amp;lt;= c, c &amp;lt;= d,
                     null $ calc a b c d, null $ calc2 a b c d, not (null $ calc3 a b c d), 
                     null $ calc4 a b c d, null $ calc5 a b c d, null $ calc6 a b c d, 
                     null $ calc7 a b c d ]

only_calc4 = [ [a, b, c, d] | a &amp;lt;- [1..6], b &amp;lt;- [1..6], c &amp;lt;- [1..12], d &amp;lt;- [1..20], 
                     a &amp;lt;= b, b &amp;lt;= c, c &amp;lt;= d,
                     null $ calc a b c d, null $ calc2 a b c d, null $ calc3 a b c d, 
                     not (null $ calc4 a b c d), null $ calc5 a b c d, null $ calc6 a b c d, 
                     null $ calc7 a b c d ]

only_calc5 = [ [a, b, c, d] | a &amp;lt;- [1..6], b &amp;lt;- [1..6], c &amp;lt;- [1..12], d &amp;lt;- [1..20], 
                     a &amp;lt;= b, b &amp;lt;= c, c &amp;lt;= d,
                     null $ calc a b c d, null $ calc2 a b c d, null $ calc3 a b c d, 
                     null $ calc4 a b c d, not (null $ calc5 a b c d), null $ calc6 a b c d, 
                     null $ calc7 a b c d ]

only_calc6 = [ [a, b, c, d] | a &amp;lt;- [1..6], b &amp;lt;- [1..6], c &amp;lt;- [1..12], d &amp;lt;- [1..20], 
                     a &amp;lt;= b, b &amp;lt;= c, c &amp;lt;= d,
                     null $ calc a b c d, null $ calc2 a b c d, null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, not (null $ calc6 a b c d),
                     null $ calc7 a b c d ]

only_calc7 = [ [a, b, c, d] | a &amp;lt;- [1..6], b &amp;lt;- [1..6], c &amp;lt;- [1..12], d &amp;lt;- [1..20], 
                     a &amp;lt;= b, b &amp;lt;= c, c &amp;lt;= d,
                     null $ calc a b c d, null $ calc2 a b c d, null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, null $ calc6 a b c d, 
                     not (null $ calc7 a b c d )]

main = do 
    print &quot;*****************************___only_calc&quot;
    t1 &amp;lt;- getCPUTime
    mapM_ print only_calc
    print &quot; &quot;

    print &quot;*****************************___only_calc2&quot;
    mapM_ print only_calc2
    print &quot; &quot;

    print &quot;*****************************___only_calc3&quot;
    mapM_ print only_calc3
    print &quot; &quot;

    print &quot;*****************************___only_calc4&quot;
    mapM_ print only_calc4
    print &quot; &quot;

    print &quot;*****************************___only_calc5&quot;
    mapM_ print only_calc5
    print &quot; &quot;

    print &quot;*****************************___only_calc6&quot;
    mapM_ print only_calc6
    print &quot; &quot;

    print &quot;*****************************___only_calc7&quot;
    mapM_ print only_calc7
    t2 &amp;lt;- getCPUTime
    let t = fromIntegral (t2-t1) * 1e-12
    print t
    print &quot; &quot;
</code></pre>"><span class="hljs-pragma">{-# LANGUAGE OverloadedStrings #-}</span>

<span class="hljs-import"><span class="hljs-keyword">import</span> Data.List</span>
<span class="hljs-import"><span class="hljs-keyword">import</span> System.CPUTime</span>

<span class="hljs-title">notWhole</span> :: <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Bool</span>
<span class="hljs-title">notWhole</span> x = fromIntegral (round x) /= x

<span class="hljs-title">cat</span> :: <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span>
<span class="hljs-title">cat</span> l m   | m &lt; <span class="hljs-number">0</span>  = <span class="hljs-number">3.1</span>
          | l == <span class="hljs-number">0</span>  = <span class="hljs-number">3.1</span>
          | notWhole l  = <span class="hljs-number">3.1</span>
          | notWhole m  = <span class="hljs-number">3.1</span>
          | otherwise  = read (show (round l) ++ show (round m))

<span class="hljs-title">f</span> :: <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">String</span>
<span class="hljs-title">f</span> x = show (round x)

<span class="hljs-title">scoreDiv</span> :: (<span class="hljs-type">Eq</span> a, <span class="hljs-type">Fractional</span> a) =&gt; a -&gt; a -&gt; a
<span class="hljs-title">scoreDiv</span> az bz  | bz == <span class="hljs-number">0</span>  = <span class="hljs-number">99999</span>
                | otherwise = (/) az bz

<span class="hljs-title">ops</span> =  [cat, (+), (-), (*), scoreDiv] 

<span class="hljs-title">calc</span> :: <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; [(<span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>)]
<span class="hljs-title">calc</span> a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op2 (op1 a' b') c' == <span class="hljs-number">20</span>]

<span class="hljs-title">calc2</span> :: <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; [(<span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>)]
<span class="hljs-title">calc2</span> a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op2 a' (op1 b' c') == <span class="hljs-number">20</span>]

<span class="hljs-title">calc3</span> :: <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; [(<span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>)]
<span class="hljs-title">calc3</span> a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op3 &lt;- ops,
                            op3 (op1 a' b') (op2 c' d') == <span class="hljs-number">20</span>]

<span class="hljs-title">calc4</span> :: <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; <span class="hljs-type">Double</span> -&gt; [(<span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>, <span class="hljs-type">Double</span>)]
<span class="hljs-title">calc4</span> a b c d = [ (a',b',c',d')  |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op3 &lt;- ops,
                            op3 (op2 (op1 a' b') c') d' == <span class="hljs-number">20</span>]

<span class="hljs-title">calc5</span> a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op3 &lt;- ops,
                            op3 (op2 a' (op1 b' c')) d' == <span class="hljs-number">20</span>]

<span class="hljs-title">calc6</span> a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op3 &lt;- ops,
                            op3 a' (op2 (op1 b' c') d') == <span class="hljs-number">20</span>]

<span class="hljs-title">calc7</span> a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op3 &lt;- ops,
                            op3 a' (op2 b' (op1 c' d')) == <span class="hljs-number">20</span>]



<span class="hljs-title">only_calc</span> = [ [a, b, c, d] | a &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">6</span>], b &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">6</span>], c &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">12</span>], d &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">20</span>], 
                     a &lt;= b, b &lt;= c, c &lt;= d,
                     not (null $ calc a b c d), null $ calc2 a b c d, null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, null $ calc6 a b c d, 
                     null $ calc7 a b c d ]


<span class="hljs-title">only_calc2</span> = [ [a, b, c, d] | a &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">6</span>], b &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">6</span>], c &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">12</span>], d &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">20</span>], 
                     a &lt;= b, b &lt;= c, c &lt;= d,
                     null $ calc a b c d, not (null $ calc2 a b c d), null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, null $ calc6 a b c d, 
                     null $ calc7 a b c d ]

<span class="hljs-title">only_calc3</span> = [ [a, b, c, d] | a &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">6</span>], b &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">6</span>], c &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">12</span>], d &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">20</span>], 
                     a &lt;= b, b &lt;= c, c &lt;= d,
                     null $ calc a b c d, null $ calc2 a b c d, not (null $ calc3 a b c d), 
                     null $ calc4 a b c d, null $ calc5 a b c d, null $ calc6 a b c d, 
                     null $ calc7 a b c d ]

<span class="hljs-title">only_calc4</span> = [ [a, b, c, d] | a &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">6</span>], b &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">6</span>], c &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">12</span>], d &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">20</span>], 
                     a &lt;= b, b &lt;= c, c &lt;= d,
                     null $ calc a b c d, null $ calc2 a b c d, null $ calc3 a b c d, 
                     not (null $ calc4 a b c d), null $ calc5 a b c d, null $ calc6 a b c d, 
                     null $ calc7 a b c d ]

<span class="hljs-title">only_calc5</span> = [ [a, b, c, d] | a &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">6</span>], b &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">6</span>], c &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">12</span>], d &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">20</span>], 
                     a &lt;= b, b &lt;= c, c &lt;= d,
                     null $ calc a b c d, null $ calc2 a b c d, null $ calc3 a b c d, 
                     null $ calc4 a b c d, not (null $ calc5 a b c d), null $ calc6 a b c d, 
                     null $ calc7 a b c d ]

<span class="hljs-title">only_calc6</span> = [ [a, b, c, d] | a &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">6</span>], b &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">6</span>], c &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">12</span>], d &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">20</span>], 
                     a &lt;= b, b &lt;= c, c &lt;= d,
                     null $ calc a b c d, null $ calc2 a b c d, null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, not (null $ calc6 a b c d),
                     null $ calc7 a b c d ]

<span class="hljs-title">only_calc7</span> = [ [a, b, c, d] | a &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">6</span>], b &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">6</span>], c &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">12</span>], d &lt;- [<span class="hljs-number">1.</span>.<span class="hljs-number">20</span>], 
                     a &lt;= b, b &lt;= c, c &lt;= d,
                     null $ calc a b c d, null $ calc2 a b c d, null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, null $ calc6 a b c d, 
                     not (null $ calc7 a b c d )]

<span class="hljs-title">main</span> = <span class="hljs-keyword">do</span> 
    print <span class="hljs-string">"*****************************___only_calc"</span>
    t1 &lt;- getCPUTime
    mapM_ print only_calc
    print <span class="hljs-string">" "</span>

    print <span class="hljs-string">"*****************************___only_calc2"</span>
    mapM_ print only_calc2
    print <span class="hljs-string">" "</span>

    print <span class="hljs-string">"*****************************___only_calc3"</span>
    mapM_ print only_calc3
    print <span class="hljs-string">" "</span>

    print <span class="hljs-string">"*****************************___only_calc4"</span>
    mapM_ print only_calc4
    print <span class="hljs-string">" "</span>

    print <span class="hljs-string">"*****************************___only_calc5"</span>
    mapM_ print only_calc5
    print <span class="hljs-string">" "</span>

    print <span class="hljs-string">"*****************************___only_calc6"</span>
    mapM_ print only_calc6
    print <span class="hljs-string">" "</span>

    print <span class="hljs-string">"*****************************___only_calc7"</span>
    mapM_ print only_calc7
    t2 &lt;- getCPUTime
    <span class="hljs-keyword">let</span> t = fromIntegral (t2-t1) * <span class="hljs-number">1e-12</span>
    print t
    print <span class="hljs-string">" "</span>
</code></pre><p>Here is what I got:</p><pre class="javascript hljs"><code class="javascript" data-origin="<pre><code class=&quot;javascript&quot;>e@e:~/b0$ ./analysis_A
&quot;*****************************___only_calc&quot;
[1.0,3.0,11.0,15.0]
[1.0,3.0,11.0,19.0]
[1.0,6.0,9.0,20.0]
[1.0,6.0,10.0,20.0]
[1.0,6.0,11.0,20.0]
[2.0,2.0,11.0,15.0]
[2.0,2.0,11.0,17.0]
[3.0,3.0,3.0,13.0]
[3.0,3.0,7.0,17.0]
[3.0,4.0,9.0,16.0]
[3.0,4.0,11.0,14.0]
[4.0,4.0,6.0,17.0]
[5.0,5.0,5.0,11.0]
[5.0,5.0,5.0,13.0]
[5.0,5.0,5.0,17.0]
&quot; &quot;
&quot;*****************************___only_calc2&quot;
&quot; &quot;
&quot;*****************************___only_calc3&quot;
[1.0,1.0,1.0,11.0]
[1.0,1.0,7.0,17.0]
[1.0,1.0,12.0,12.0]
[1.0,6.0,6.0,6.0]
[1.0,6.0,9.0,9.0]
[3.0,3.0,6.0,6.0]
[3.0,4.0,7.0,18.0]
[3.0,6.0,7.0,14.0]
[5.0,5.0,6.0,17.0]
[5.0,6.0,6.0,6.0]
&quot; &quot;
&quot;*****************************___only_calc4&quot;
[1.0,1.0,4.0,11.0]
[1.0,4.0,9.0,9.0]
[1.0,4.0,9.0,19.0]
[1.0,5.0,11.0,11.0]
[1.0,6.0,6.0,12.0]
[1.0,6.0,11.0,11.0]
[3.0,6.0,9.0,12.0]
[6.0,6.0,7.0,18.0]
[6.0,6.0,9.0,14.0]
&quot; &quot;
&quot;*****************************___only_calc5&quot;
[1.0,3.0,8.0,20.0]
[3.0,3.0,10.0,17.0]
[3.0,4.0,10.0,16.0]
&quot; &quot;
&quot;*****************************___only_calc6&quot;
&quot; &quot;
&quot;*****************************___only_calc7&quot;
8.27113
&quot; &quot;
</code></pre>">e@e:~<span class="hljs-regexp">/b0$ ./</span>analysis_A
<span class="hljs-string">"*****************************___only_calc"</span>
[<span class="hljs-number">1.0</span>,<span class="hljs-number">3.0</span>,<span class="hljs-number">11.0</span>,<span class="hljs-number">15.0</span>]
[<span class="hljs-number">1.0</span>,<span class="hljs-number">3.0</span>,<span class="hljs-number">11.0</span>,<span class="hljs-number">19.0</span>]
[<span class="hljs-number">1.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">9.0</span>,<span class="hljs-number">20.0</span>]
[<span class="hljs-number">1.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">10.0</span>,<span class="hljs-number">20.0</span>]
[<span class="hljs-number">1.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">11.0</span>,<span class="hljs-number">20.0</span>]
[<span class="hljs-number">2.0</span>,<span class="hljs-number">2.0</span>,<span class="hljs-number">11.0</span>,<span class="hljs-number">15.0</span>]
[<span class="hljs-number">2.0</span>,<span class="hljs-number">2.0</span>,<span class="hljs-number">11.0</span>,<span class="hljs-number">17.0</span>]
[<span class="hljs-number">3.0</span>,<span class="hljs-number">3.0</span>,<span class="hljs-number">3.0</span>,<span class="hljs-number">13.0</span>]
[<span class="hljs-number">3.0</span>,<span class="hljs-number">3.0</span>,<span class="hljs-number">7.0</span>,<span class="hljs-number">17.0</span>]
[<span class="hljs-number">3.0</span>,<span class="hljs-number">4.0</span>,<span class="hljs-number">9.0</span>,<span class="hljs-number">16.0</span>]
[<span class="hljs-number">3.0</span>,<span class="hljs-number">4.0</span>,<span class="hljs-number">11.0</span>,<span class="hljs-number">14.0</span>]
[<span class="hljs-number">4.0</span>,<span class="hljs-number">4.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">17.0</span>]
[<span class="hljs-number">5.0</span>,<span class="hljs-number">5.0</span>,<span class="hljs-number">5.0</span>,<span class="hljs-number">11.0</span>]
[<span class="hljs-number">5.0</span>,<span class="hljs-number">5.0</span>,<span class="hljs-number">5.0</span>,<span class="hljs-number">13.0</span>]
[<span class="hljs-number">5.0</span>,<span class="hljs-number">5.0</span>,<span class="hljs-number">5.0</span>,<span class="hljs-number">17.0</span>]
<span class="hljs-string">" "</span>
<span class="hljs-string">"*****************************___only_calc2"</span>
<span class="hljs-string">" "</span>
<span class="hljs-string">"*****************************___only_calc3"</span>
[<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>,<span class="hljs-number">11.0</span>]
[<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>,<span class="hljs-number">7.0</span>,<span class="hljs-number">17.0</span>]
[<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>,<span class="hljs-number">12.0</span>,<span class="hljs-number">12.0</span>]
[<span class="hljs-number">1.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">6.0</span>]
[<span class="hljs-number">1.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">9.0</span>,<span class="hljs-number">9.0</span>]
[<span class="hljs-number">3.0</span>,<span class="hljs-number">3.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">6.0</span>]
[<span class="hljs-number">3.0</span>,<span class="hljs-number">4.0</span>,<span class="hljs-number">7.0</span>,<span class="hljs-number">18.0</span>]
[<span class="hljs-number">3.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">7.0</span>,<span class="hljs-number">14.0</span>]
[<span class="hljs-number">5.0</span>,<span class="hljs-number">5.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">17.0</span>]
[<span class="hljs-number">5.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">6.0</span>]
<span class="hljs-string">" "</span>
<span class="hljs-string">"*****************************___only_calc4"</span>
[<span class="hljs-number">1.0</span>,<span class="hljs-number">1.0</span>,<span class="hljs-number">4.0</span>,<span class="hljs-number">11.0</span>]
[<span class="hljs-number">1.0</span>,<span class="hljs-number">4.0</span>,<span class="hljs-number">9.0</span>,<span class="hljs-number">9.0</span>]
[<span class="hljs-number">1.0</span>,<span class="hljs-number">4.0</span>,<span class="hljs-number">9.0</span>,<span class="hljs-number">19.0</span>]
[<span class="hljs-number">1.0</span>,<span class="hljs-number">5.0</span>,<span class="hljs-number">11.0</span>,<span class="hljs-number">11.0</span>]
[<span class="hljs-number">1.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">12.0</span>]
[<span class="hljs-number">1.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">11.0</span>,<span class="hljs-number">11.0</span>]
[<span class="hljs-number">3.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">9.0</span>,<span class="hljs-number">12.0</span>]
[<span class="hljs-number">6.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">7.0</span>,<span class="hljs-number">18.0</span>]
[<span class="hljs-number">6.0</span>,<span class="hljs-number">6.0</span>,<span class="hljs-number">9.0</span>,<span class="hljs-number">14.0</span>]
<span class="hljs-string">" "</span>
<span class="hljs-string">"*****************************___only_calc5"</span>
[<span class="hljs-number">1.0</span>,<span class="hljs-number">3.0</span>,<span class="hljs-number">8.0</span>,<span class="hljs-number">20.0</span>]
[<span class="hljs-number">3.0</span>,<span class="hljs-number">3.0</span>,<span class="hljs-number">10.0</span>,<span class="hljs-number">17.0</span>]
[<span class="hljs-number">3.0</span>,<span class="hljs-number">4.0</span>,<span class="hljs-number">10.0</span>,<span class="hljs-number">16.0</span>]
<span class="hljs-string">" "</span>
<span class="hljs-string">"*****************************___only_calc6"</span>
<span class="hljs-string">" "</span>
<span class="hljs-string">"*****************************___only_calc7"</span>
<span class="hljs-number">8.27113</span>
<span class="hljs-string">" "</span>
</code></pre><h1 id="this-shows-that-there-is-no-solution-that-only-calc2,-only-calc6,-or-only-calc7-can-find.-next,-i-checkes-all-combinations-of-these-three:"><a name="this-shows-that-there-is-no-solution-that-only-calc2,-only-calc6,-or-only-calc7-can-find.-next,-i-checkes-all-combinations-of-these-three:" href="#this-shows-that-there-is-no-solution-that-only-calc2,-only-calc6,-or-only-calc7-can-find.-next,-i-checkes-all-combinations-of-these-three:"></a>This shows that there is no solution that only calc2, only calc6, or only calc7 can find. Next, I checkes all combinations of these three:</h1><pre class="javascript hljs"><code class="javascript" data-origin="<pre><code class=&quot;javascript&quot;>{-# LANGUAGE OverloadedStrings #-}

import Data.List
import System.CPUTime

notWhole :: Double -&amp;gt; Bool
notWhole x = fromIntegral (round x) /= x

cat :: Double -&amp;gt; Double -&amp;gt; Double
cat l m   | m &amp;lt; 0  = 3.1
          | l == 0  = 3.1
          | notWhole l  = 3.1
          | notWhole m  = 3.1
          | otherwise  = read (show (round l) ++ show (round m))

f :: Double -&amp;gt; String
f x = show (round x)

scoreDiv :: (Eq a, Fractional a) =&amp;gt; a -&amp;gt; a -&amp;gt; a
scoreDiv az bz  | bz == 0  = 99999
                | otherwise = (/) az bz

ops =  [cat, (+), (-), (*), scoreDiv] 

calc :: Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; [(Double, Double, Double, Double)]
calc a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op2 (op1 a' b') c' == 20]

calc2 :: Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; [(Double, Double, Double, Double)]
calc2 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op2 a' (op1 b' c') == 20]

calc3 :: Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; [(Double, Double, Double, Double)]
calc3 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op3 &amp;lt;- ops,
                            op3 (op1 a' b') (op2 c' d') == 20]

calc4 :: Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; Double -&amp;gt; [(Double, Double, Double, Double)]
calc4 a b c d = [ (a',b',c',d')  |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op3 &amp;lt;- ops,
                            op3 (op2 (op1 a' b') c') d' == 20]

calc5 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op3 &amp;lt;- ops,
                            op3 (op2 a' (op1 b' c')) d' == 20]

calc6 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op3 &amp;lt;- ops,
                            op3 a' (op2 (op1 b' c') d') == 20]

calc7 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &amp;lt;- nub(permutations [a,b,c,d]),
                            op1 &amp;lt;- ops,
                            op2 &amp;lt;- ops,
                            op3 &amp;lt;- ops,
                            op3 a' (op2 b' (op1 c' d')) == 20]

only_calc2_or_6 = [ [a, b, c, d] | a &amp;lt;- [1..6], b &amp;lt;- [1..6], c &amp;lt;- [1..12], d &amp;lt;- [1..20], 
                     a &amp;lt;= b, b &amp;lt;= c, c &amp;lt;= d,
                     null $ calc a b c d, not (null $ calc2 a b c d), null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, not (null $ calc6 a b c d), 
                     null $ calc7 a b c d ]

only_calc2_or_7 = [ [a, b, c, d] | a &amp;lt;- [1..6], b &amp;lt;- [1..6], c &amp;lt;- [1..12], d &amp;lt;- [1..20], 
                     a &amp;lt;= b, b &amp;lt;= c, c &amp;lt;= d,
                     null $ calc a b c d, not (null $ calc2 a b c d), null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, null $ calc6 a b c d, 
                     not (null $ calc7 a b c d) ]

only_calc6_or_7 = [ [a, b, c, d] | a &amp;lt;- [1..6], b &amp;lt;- [1..6], c &amp;lt;- [1..12], d &amp;lt;- [1..20], 
                     a &amp;lt;= b, b &amp;lt;= c, c &amp;lt;= d,
                     null $ calc a b c d, null $ calc2 a b c d, null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, not (null $ calc6 a b c d), 
                     not (null $ calc7 a b c d )]


only_calc2_or_6_or_7 = [ [a, b, c, d] | a &amp;lt;- [1..6], b &amp;lt;- [1..6], c &amp;lt;- [1..12], d &amp;lt;- [1..20], 
                     a &amp;lt;= b, b &amp;lt;= c, c &amp;lt;= d,
                     null $ calc a b c d, not (null $ calc2 a b c d), null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, not (null $ calc6 a b c d), 
                     not (null $ calc7 a b c d )]

main = do 
    print &quot;*****************************___only_calc2_and_6&quot;
    t1 &amp;lt;- getCPUTime
    mapM_ print only_calc2_or_6
    print &quot; &quot;

    print &quot;*****************************___only_calc2_and_7&quot;
    mapM_ print only_calc2_or_7
    print &quot; &quot;

    print &quot;*****************************___only_calc6_and_7&quot;
    mapM_ print only_calc6_or_7
    print &quot; &quot;

    print &quot;*****************************___only_calc2_and_6_and_7&quot;
    mapM_ print only_calc2_or_6_or_7
    t2 &amp;lt;- getCPUTime
    let t = fromIntegral (t2-t1) * 1e-12
    print t
</code></pre>">{-# LANGUAGE OverloadedStrings #-}

import Data.List
import System.CPUTime

notWhole :: Double -&gt; Bool
notWhole x = fromIntegral (round x) /= x

cat :: Double -&gt; Double -&gt; Double
cat l m   | m &lt; 0  = 3.1
          | l == 0  = 3.1
          | notWhole l  = 3.1
          | notWhole m  = 3.1
          | otherwise  = read (show (round l) ++ show (round m))

f :: Double -&gt; String
f x = show (round x)

scoreDiv :: (Eq a, Fractional a) =&gt; a -&gt; a -&gt; a
scoreDiv az bz  | bz == 0  = 99999
                | otherwise = (/) az bz

ops =  [cat, (+), (-), (*), scoreDiv] 

calc :: Double -&gt; Double -&gt; Double -&gt; Double -&gt; [(Double, Double, Double, Double)]
calc a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op2 (op1 a' b') c' == 20]

calc2 :: Double -&gt; Double -&gt; Double -&gt; Double -&gt; [(Double, Double, Double, Double)]
calc2 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op2 a' (op1 b' c') == 20]

calc3 :: Double -&gt; Double -&gt; Double -&gt; Double -&gt; [(Double, Double, Double, Double)]
calc3 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op3 &lt;- ops,
                            op3 (op1 a' b') (op2 c' d') == 20]

calc4 :: Double -&gt; Double -&gt; Double -&gt; Double -&gt; [(Double, Double, Double, Double)]
calc4 a b c d = [ (a',b',c',d')  |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op3 &lt;- ops,
                            op3 (op2 (op1 a' b') c') d' == 20]

calc5 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op3 &lt;- ops,
                            op3 (op2 a' (op1 b' c')) d' == 20]

calc6 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op3 &lt;- ops,
                            op3 a' (op2 (op1 b' c') d') == 20]

calc7 a b c d = [ (a',b',c',d') |
                        [a',b',c',d'] &lt;- nub(permutations [a,b,c,d]),
                            op1 &lt;- ops,
                            op2 &lt;- ops,
                            op3 &lt;- ops,
                            op3 a' (op2 b' (op1 c' d')) == 20]

only_calc2_or_6 = [ [a, b, c, d] | a &lt;- [1..6], b &lt;- [1..6], c &lt;- [1..12], d &lt;- [1..20], 
                     a &lt;= b, b &lt;= c, c &lt;= d,
                     null $ calc a b c d, not (null $ calc2 a b c d), null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, not (null $ calc6 a b c d), 
                     null $ calc7 a b c d ]

only_calc2_or_7 = [ [a, b, c, d] | a &lt;- [1..6], b &lt;- [1..6], c &lt;- [1..12], d &lt;- [1..20], 
                     a &lt;= b, b &lt;= c, c &lt;= d,
                     null $ calc a b c d, not (null $ calc2 a b c d), null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, null $ calc6 a b c d, 
                     not (null $ calc7 a b c d) ]

only_calc6_or_7 = [ [a, b, c, d] | a &lt;- [1..6], b &lt;- [1..6], c &lt;- [1..12], d &lt;- [1..20], 
                     a &lt;= b, b &lt;= c, c &lt;= d,
                     null $ calc a b c d, null $ calc2 a b c d, null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, not (null $ calc6 a b c d), 
                     not (null $ calc7 a b c d )]


only_calc2_or_6_or_7 = [ [a, b, c, d] | a &lt;- [1..6], b &lt;- [1..6], c &lt;- [1..12], d &lt;- [1..20], 
                     a &lt;= b, b &lt;= c, c &lt;= d,
                     null $ calc a b c d, not (null $ calc2 a b c d), null $ calc3 a b c d, 
                     null $ calc4 a b c d, null $ calc5 a b c d, not (null $ calc6 a b c d), 
                     not (null $ calc7 a b c d )]

main = do 
    print "*****************************___only_calc2_and_6"
    t1 &lt;- getCPUTime
    mapM_ print only_calc2_or_6
    print " "

    print "*****************************___only_calc2_and_7"
    mapM_ print only_calc2_or_7
    print " "

    print "*****************************___only_calc6_and_7"
    mapM_ print only_calc6_or_7
    print " "

    print "*****************************___only_calc2_and_6_and_7"
    mapM_ print only_calc2_or_6_or_7
    t2 &lt;- getCPUTime
    let t = fromIntegral (t2-t1) * 1e-12
    print t
</code></pre><p>And here is what I got:</p><pre class="javascript hljs"><code class="javascript" data-origin="<pre><code class=&quot;javascript&quot;>    e@e:~/b0$ ./analysis_B
&quot;*****************************___only_calc2_and_6&quot;
&quot; &quot;
&quot;*****************************___only_calc2_and_7&quot;
&quot; &quot;
&quot;*****************************___only_calc6_and_7&quot;
&quot; &quot;
&quot;*****************************___only_calc2_and_6_and_7&quot;
[2.0,5.0,12.0,12.0]
3.385727
</code></pre>">    e@e:~<span class="hljs-regexp">/b0$ ./</span>analysis_B
<span class="hljs-string">"*****************************___only_calc2_and_6"</span>
<span class="hljs-string">" "</span>
<span class="hljs-string">"*****************************___only_calc2_and_7"</span>
<span class="hljs-string">" "</span>
<span class="hljs-string">"*****************************___only_calc6_and_7"</span>
<span class="hljs-string">" "</span>
<span class="hljs-string">"*****************************___only_calc2_and_6_and_7"</span>
[<span class="hljs-number">2.0</span>,<span class="hljs-number">5.0</span>,<span class="hljs-number">12.0</span>,<span class="hljs-number">12.0</span>]
<span class="hljs-number">3.385727</span>
</code></pre><h1 id="there-are-no-rolls-of-the-dice-that-can-be-found-only-by-some-pair-of-these-functions,-and-(2,5,12,12)-is-the-only-roll-that-can-be-found-by-all-three,-but-none-of-the-other-algorythms-(calc,-calc3,-calc4,-and-calc5).-those-four-along-with-any-one-of-calc2,-calc6,-or-calc7,-are-sufficient-to-find-at-least-one-solution-if-a-roll-is-solvable.-a-corrolary-is-that-if-calc,-calc2,-calc3,-calc4,-and-calc5-can't-find-a-solution,-calc6-and-calc7-won't-either.-i-tested-this-by-removing-calc6-and-calc7-from-impossibles.hs-and-renaming-it-impossibles2.hs.-like-impossibles.hs,-it-found-the-104-impossible-rolls,-only-in-1.33-instead-of-1.50-seconds."><a name="there-are-no-rolls-of-the-dice-that-can-be-found-only-by-some-pair-of-these-functions,-and-(2,5,12,12)-is-the-only-roll-that-can-be-found-by-all-three,-but-none-of-the-other-algorythms-(calc,-calc3,-calc4,-and-calc5).-those-four-along-with-any-one-of-calc2,-calc6,-or-calc7,-are-sufficient-to-find-at-least-one-solution-if-a-roll-is-solvable.-a-corrolary-is-that-if-calc,-calc2,-calc3,-calc4,-and-calc5-can't-find-a-solution,-calc6-and-calc7-won't-either.-i-tested-this-by-removing-calc6-and-calc7-from-impossibles.hs-and-renaming-it-impossibles2.hs.-like-impossibles.hs,-it-found-the-104-impossible-rolls,-only-in-1.33-instead-of-1.50-seconds." href="#there-are-no-rolls-of-the-dice-that-can-be-found-only-by-some-pair-of-these-functions,-and-(2,5,12,12)-is-the-only-roll-that-can-be-found-by-all-three,-but-none-of-the-other-algorythms-(calc,-calc3,-calc4,-and-calc5).-those-four-along-with-any-one-of-calc2,-calc6,-or-calc7,-are-sufficient-to-find-at-least-one-solution-if-a-roll-is-solvable.-a-corrolary-is-that-if-calc,-calc2,-calc3,-calc4,-and-calc5-can't-find-a-solution,-calc6-and-calc7-won't-either.-i-tested-this-by-removing-calc6-and-calc7-from-impossibles.hs-and-renaming-it-impossibles2.hs.-like-impossibles.hs,-it-found-the-104-impossible-rolls,-only-in-1.33-instead-of-1.50-seconds."></a>There are no rolls of the dice that can be found only by some pair of these functions, and (2,5,12,12) is the only roll that can be found by all three, but none of the other algorythms (calc, calc3, calc4, and calc5). Those four along with any one of calc2, calc6, or calc7, are sufficient to find at least one solution if a roll is solvable. A corrolary is that if calc, calc2, calc3, calc4, and calc5 can’t find a solution, calc6 and calc7 won’t either. I tested this by removing calc6 and calc7 from impossibles.hs and renaming it impossibles2.hs. Like impossibles.hs, it found the 104 impossible rolls, only in 1.33 instead of 1.50 seconds.</h1><p>The module Fm uses the seven algorythms to find solutions to random rolls or numbers entered by Score players. It massages the output into a single line of Text with solutions separated by “<br>“. The browsers receive the Text as a Javascript string which, when appended to a div, displays the solutions neatly in a column.</p>

<footer style="position:fixed; font-size:.8em; text-align:right; bottom:0px; margin-left:-25px; height:20px; width:100%;">generated by <a href="http://pad.haroopress.com" target="_blank">haroopad</a></footer>
</div>
</body>
</html>
